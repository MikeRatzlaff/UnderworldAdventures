<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Underworld Adventures is a project to recreate Ultima Underworld 1 on modern operating systems, using the original game files." />
    <meta name="keywords" content="ultima underworld adventures uw1 hack project" />
    <title>Underworld Adventures - Developer's Log for the Underworld Adventures project</title>
    <link href="css/uwadv.css" rel="stylesheet" type="text/css" />
    <link rel="canonical" href="https://vividos.github.io/UnderworldAdventures/devlog.html">
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
</head>
<body>

    <!-- title bar -->
    <div class="bordered-box" style="height: 64px; background-color:#7f7f7f; ">
        <div style="overflow: hidden; background-color: #7f7f7f">
            <img style="float: left" width="448" height="64" src="images/top1.jpg" alt="Underworld Adventures logo part 1" />
            <img style="float: right" class="right-header-image" width="136" height="64" src="images/top2.jpg" alt="Underworld Adventures logo part 2" />
        </div>
    </div>

    <!-- menu and content -->
    <div class="bordered-box menu-container" style="overflow: hidden">
        <div class="top-menu light-background" style="text-align:center; padding: 5px">
            <a href="index.html">News</a> -
            <a href="download.html">Download</a> -
            <a href="screenshots.html">Screenshots</a> -
            <a href="development.html">Development</a>
        </div>
        <div class="left-menu light-background" style="padding: 5px">
            <p>
                * <a href="index.html">News</a><br />
                * <a href="download.html">Download</a><br />
                * <a href="screenshots.html">Screenshots</a><br />
                * <a href="development.html">Development</a>
            </p>
        </div>
        <div style="overflow: hidden; padding: 8px; padding-left:32px; padding-right:32px; flex: 1">
            <!-- content -->

            <h1>Developer's Log</h1>

            <p>
                The dev log is the place where I write about the ongoings of the project. It is
                updated occasionally.
            </p>

            <h3>2019-09-28</h3>
            <p>
                I'm occasionally working on uwadv, this time refactoring some classes in the
                renderer in order to fix bugs or enable some commented out code. From time to time
                I get the thought of "how could I possibly write such bad code", but I guess so is
                developer's life cycle.
            </p>

            <p>
                Decals and tmap objects (levers and dials) are now rendered again. Also there was
                some fixes to the object loader that would not link objects to their tiles,
                resulting in no objects displayed at all. Also some fixes for Lua code that should
                be written differently in Lua 5.3.
            </p>

            <p>
                In other news, the AppVeyor build service that builds the whole uwadv project om
                every check in now produces versioned zip files, and also the main executables now
                all have a version info resource.
            </p>

            <hr />

            <h3>2019-09-19</h3>
            <p>
                I just noticed that the uwadv project was mentioned on
                <a href="http://gigi.nullneuron.net/ultima/index.php">Dino's Ultima Page</a>, one
                of the view still active Ultima fan pages. I occasionally read the pages for
                details on Ultima Underworld or just to reminisce about the old days playing
                Ultima games.
            </p>

            <hr />

            <h3>2019-05-09</h3>

            <p>
                I worked on collision detection, writing unit test and trying to fix bugs when
                walking through the level. Telemachos' tutorial from past times was a great help,
                but over the years some people noticed some numerical instabilities in the
                algorithm, leading to some articles. I tried to incorporate the fixes proposed,
                but am not entirely satisfied.
            </p>

            <p>
                I also merged in the changes in the MIDI code from the Exult source that shares
                the code with Pentagram (and now also with Underworld Adventures). I figured out
                that the file "uw.mt" in Ultima Underworld is a Timbre library (whatever that is)
                and that the MIDI code can load the file. I'm not sure if there's an audible
                difference, though.
            </p>

            <hr />

            <h3>2019-04-09</h3>
            <hr />

            <p>
                I'm currently working on cleaning up the code base from the refactoring that I
                started in 2003, before quit working on the project in 2007. I'm using Visual
                Studio 2019 Community edition, which works great and even got back the resource
                editor. Some tools are already ported, some are still missing. I also updated to
                the latest libraries of SDL2 and zzip.
            </p>

            <p>
                Back then I started to improve the code base by rewriting the libraries, starting
                from the base library and half-finishing the import library. Nowadays I would do
                things differently, trying to evolve the code base, but it seems I'm a bit smarter
                after 16 years. There's lots to be done, and no set time for a new release, since
                I'm only working on the project occasionally.
            </p>

            <p>
                One of the first new features is that converting the file names of the original
                uw1 or uw2 files to lowercase isn't necessary anymore, as the resource manager in
                uwadv now builds a mapping from logical filenames to actual filenames on the hard
                disk. The same resource manager allows that the game files can directly be loaded
                from a zip archive, so extracting the game files isn't necessary anymore.
            </p>

            <h3>2019-02-02</h3>
            <p>
                Today I moved the source code for Underworld Adventures from SourceForge's CVS
                hosting, which is in obsolete and read-only mode for some time, to GitHub.
                Converting was done with cvs2git, which involved downloading a CVS backup with
                rsync and then converting it on SourceForge's Shell services. So the whole
                development history of the project is now preserved on the
                <a href="https://github.com/vividos/UnderworldAdventures">GitHub project for Underworld Adventures</a>.
            </p>

            <p>
                I also began converting the web pages that are hosted on
                <a href="http://uwadv.sourceforge.net/">SourceForge.net</a> to modern HTML5, using
                flex-box and a responsive design based on the old pages. Now the pages look nice
                even on smartphones. I also put up a note on the SourceForge project page with the
                new URL of the web pages, at
                <a href="https://vividos.github.io/UnderworldAdventures/">https://vividos.github.io/UnderworldAdventures/</a>.
            </p>

            <hr />

            <h3>2005-02-16</h3>
            <p>
                Started working on code debuggers by adding the ability to send messages to the client and send "start" and "end" messages for code debuggers. On the client side one or more code debuggers can be active, all with their own breakpoint lists, etc. Actually in uwadv there will be two different code debuggers, one for conversation code, and one for Lua code. A code debugger can be set in one of several states, such as running, stopped, single-stepping, stepping out. The client can set and query breakpoints. When in "running" mode it gets a message when a breakpoint is reached. Also fixed the ua_physics_check_point_in_triangle() where I introduced a bug that shows in physics code when fixing some compiler warnings.
            </p>

            <h3>2005-01-22</h3>
            <p>
                Improved master object list viewing and client interface. Added editing for all values.
            </p>

            <h3>2005-01-19</h3>
            <p>
                Added common base class for docking and child windows. Added project info docking window that later should show all Lua source files and all active code debuggers.
            </p>

            <h3>2005-01-18</h3>
            <p>
                Added the new Underworld Adventures Debugger that is done using WTL and uses several third-party source libs such as docking windows, tabbed windows and xp-style menus. Added needed project files. Updated version info of all generated binaries.
            </p>

            <h3>2005-01-17</h3>
            <p>
                Many minor changes at several places. Removed some tools and added project files for some tools.
            </p>

            <h3>2005-01-11</h3>
            <p>
                Added sources for Underworld Adventures Studio project. The uastudio basically is a stripped-down game that doesn't display graphics and has no user interaction, but it hosts a full game. The debugger is started automatically, so in the end it looks as the user has started a "Studio" application to develop and test custom games. Also enabled new-style browsing for folders to the "Underworld Adventures Config" program.
            </p>

            <h3>2005-01-10</h3>
            <p>
                Started adding project files for vc71. Now every subfolder (and "component", such as "base", etc.) gets its own project file and thus static library.
            </p>

            <h3>2004-11-27</h3>
            <p>
                Worked on the underworld debugger and put tabbed MDI browsing, XP Menu and docked windows together. Here's a screenshot showing the look of the program so far:<br />
                <a href="images/devel/uadebug06.png" data-sub-html="User Interface">
                    <img src="images/devel/uadebug06.jpg" alt="user interface" />
                </a><br />
            </p>
            <p>
                Fixed tilemap rendering slowness by using a memory DC. And on the tilemap view there are now two boxes with infos about the currently clicked tile and it's objects. I plan to use icons directly from the games for the objects.
            </p>

            <h3>2004-10-27</h3>
            <p>
                Worked on the tilemap view and improved rendering. Drawing the diagonal tiles is painfully slow, though (GDI polygons). Here's a screenshot:
            </p>
            <p>
                <a href="images/devel/uadebug05.png" data-sub-html="Tilemap view">
                    <img src="images/devel/uadebug05.jpg" alt="tilemap view" />
                </a><br />
                Clicking on any tile in the view lets you view the tile info. The button teleports the player to the new position (makes hotspot list almost useless). Later the objects in the current tile should be listed in the empty box below the tile's data. Each object should get it's 16x16 icon from the game, and object properties can then be edited in another dockable window for "object properties".
            </p>
            <p>
                You can also see David Bowen's Tabbed MDI window magic. It has a tab for any MDI (non-dockable windows) that are in the app's working area. Unfortunately Sergey Klimov's Docking framework doesn't quite work together with the tabbing framework. And the XP style menu of course doesn't work together with all other frameworks. Oh well ...
            </p>

            <h3>2004-10-18</h3>
            <p>
                Improved RSS output a bit, Feedreader had some problems with RFC 822 dates without correct time. Also added a limiter so that html output is limited to the last 10 items, and RSS is limited to the last 8. I guess good RSS aggregators store the older articles somewhere. At the end of the html output is a link to retrieve the full log.
            </p>

            <h3>2004-10-17</h3>
            <p>
                Worked on the debugger's object list docking window (which should probably be a full MDI view) today, but it isn't finished yet. It is planned that values changed between two updates are drawn with red background. Editing values also still don't work. It is planned that the object list is more an "advanced" view for the real hacker. Object placement and modification should normally done using the tilemap viewer and some "object property sheet". It may even be good to do some wizard to accomplish more complex tasks, such as a "Place Trap Wizard".
            </p>

            <h3>2004-10-12</h3>
            <p>
                I'm currently working (for the last month or so) on a new Underworld Adventures Debugger implementation using <a href="http://wtl.sourceforge.net" target="_blank">WTL</a> as UI library. This way I get much quicker to what I have planned to do. I've also done a "uastudio" project that basically is a cut-down uwadv executable that only contains the game engine, needed classes and runs the game's main loop. It additionally starts the debugger. "uastudio" is the "Underworld Adventures Studio" application and helps me to quickly develop the new uadebug.dll. Additionally to the debugger I'm extending the ua_debug_server_interface interface to extract the needed infos. I've done some screenshots to show off what I've done so far. Click on them to show the larger version.
            </p>
            <p>
                <a href="images/devel/uadebug01.png" data-sub-html="Game strings view">
                    <img src="images/devel/uadebug01.jpg" alt="game strings view" />
                </a><br />
                This is the game strings view. The shown text block can be selected with the combo box, and the list just shows the strings. The little black squares are newlines that should be replaced with \n soon. In general you have a menu bar (with cool XP style menus, yeah!) and a toolbar (technically a command bar). Notable is the "play" button which can suspend and resume the game loop in the game. You only will be allowed to change values when the engine is stopped. Next to the button are the ugly designed buttons that enable all the goodies the debugger can view. First one is "player info", then comes "object list", "hotspot list", "tilemap view" and "gamestrings view". If someone has better icons, just send them!
            </p>
            <p>
                <a href="images/devel/uadebug02.png" data-sub-html="Tilemap view">
                    <img src="images/devel/uadebug02.jpg" alt="tilemap view" />
                </a><br />
                Shot 2 shows the tilemap viewer. It's still in the making, and it only shows the first map of the level (level map management will be added soon). Later you will be able to click on a square and see/modify its tile type, height, wall, ceiling and door textures. It is also planned to add an object editor into this view, so that objects can be conveniently placed.
            </p>
            <p>
                <a href="images/devel/uadebug03.png" data-sub-html="Lua source file editor">
                    <img src="images/devel/uadebug03.jpg" alt="lua source file editor" />
                </a><br />
                Shot 3 shows the Lua source file editor. The window uses <a href="http://www.scintilla.org" target="_blank">Scintilla</a> for editing and syntax highlighting. When Lua code debugging is built in (this has to wait a bit), you can set breakpoints on the gray area to the left, just like in Visual Studio. A "project" pane that docks to the left side is also planned. It lists all Lua files that a "game" currently has loaded.
            </p>
            <p>
                <a href="images/devel/uadebug04.png" data-sub-html="Hotspot list and player info">
                    <img src="images/devel/uadebug04.jpg" alt="hotspot list and player info" />
                </a><br />
                Finally, shot 4 shows the hotspot list and the player info, with no main window open. This means you certainly need more than a 800x600 screen resolution to conveniently work with uadebug. Player info even allows changing values, so modifying the "maplevel" teleports you to another level, and changing "xpos" and "ypos" moves you around in the level. Not very usable in uastudio, though :)
            </p>
            <p>
                Used technologies were WTL (for the general UI stuff), David Bowen's Tabbing Framework (not shown yet), Sergey Klimov's Docking Framework, a hacked-up version of MenuXP (all three from <a href="http://codeproject.com/WTL/" target="_blank">www.codeproject.com/WTL/</a>).
            </p>

            <h3>2004-10-10</h3>
            <p>
                uwadv's devlog now conforms to RSS 2.0 and Feedvalidator confirms this: <a href="http://feedvalidator.org/check.cgi?url=http://uwadv.sourceforge.net/devlog.php?type=rss">check</a>. The date wasn't RFC 822 conform, and the description tag must encode html chars like &lt; and &gt; as entities.
            </p>

            <h3>2004-09-08</h3>
            <p>
                I modified the devlog so that devlog entries are stored in an xml file and the web output is done using an xsl-transformation. At least that was my initial thought. SF doesn't directly support that, so I had to use the expat parser, which registers callback functions for elements. The handlers then output html code. It's more limited than xsl-transformations, but it suffices for what I want to do here. I've also done RSS 2.0 output so that everyone with an RSS aggregator can read the devlog. I then tried SharpReader and Amphetadesk. The results look ok, but both aggregators seem to have problems with the embedded html code, so links won't show up, and other small problems. Also the pubDate field isn't formatted correctly as in RFC 822, but I'm too lazy to do that now.
            </p>

            <h3>2004-07-13</h3>
            <p>
                Flushing out stdout and stderr when an ua_assert condition is false. This helps in debugging when the output files at least have *some* output. Worked on improving decompiling conversation code all day and it really gets nice. The opcodes are first put in a "graph" with different graph item types, the first being "opcode". Opcodes are then examined, function starts and ends are added, and additional "expression" and "operator" items are put in, too. Processed opcodes are marked done. Operators consume zero or more expressions and may yield no or one expression. Expressions are things like local variable value or pointer to memory location. They can have the attribute "value-of" and "address-of".
            </p>
            <p>
                In the next step operations search their needed expression from the graph and combine them to new expressions or a new type of graph item, a statement. The statement doesn't need expressions and doesn't yield one. The items are properly inserted in the graph and used items are marked done. Dumping the graph then shows the work already done on the graph. Currently there are only some opcodes left that are rarely used. And control structures like "if", "while" and "switch" aren't put in yet. Another problem is with temporary local variables that are set and directly used in function calls then (in conv. code all parameters are passed by-reference). The function call is inserted before all temporary parameters are set, but this should be easily fixed.
            </p>

            <h3>2004-06-29</h3>
            <p>
                Added some code to debug server to load new games and to retrieve current game.cfg path. Added done_game() function to clean up a game in the main game object.
            </p>

            <h3>2004-06-17</h3>
            <p>
                Reworked debug server and client architecture. All function calls are now made through a vtable ptr that the client gets when starting up. This also should work under linux and probably other OSes when the uwadv application and the uadebug shared library are compiled with the same compiler. Introduced class ua_debug_lib_context which can be customized for different OSes to load the shared library and start up the debugger. Removed win32 specific file with debugger implementation. All targets now share the same code. Fixed/changed some debugger code.
            </p>

            <h3>2004-06-05</h3>
            <p>
                Aisha Fenton sent an image of the MacOS X port, running uwadv on a mac desktop. Nice!
            </p>

            <h3>2004-05-18</h3>
            <p>
                Fixed drawing text edit window when using prefix text. Re-added intrinsic "babl_ask" to conversation screen to type in custom answers, e.g. when talking to Lakshi Longtooth. The string is then allocated in the local strings list and the handle is passed back to the code vm. Added getting npc global variables.
            </p>

            <h3>2004-05-17</h3>
            <p>
                Fixed some gamestrings loading bugs. Separated conv. code loading into ua_uw_import class, changed data types enum and removed exception usage when vm errors occur. Separated graphics import functions into ua_uw_import_gfx class to not having a dependency on including "image.hpp" (needed for ua_palette256).
            </p>

            <h3>2004-05-06</h3>
            <p>
                Moved game strings class from underworld to game object and fixed usage throughout the sourcecode. Moved conv. globals and conv. stack classes to own header files. Partly commented out conversation functionality, which will be reworked later.
            </p>

            <h3>2004-04-29</h3>
            <p>
                Added ua_assert macro that checks for users errors and game conditions and throws an exception when needed. Added ua_levelmaps_list class which contains the list of ua_level objects in the underworld. Separated conversation globals loading into own file and updated conversation class accordingly.
            </p>

            <h3>2004-04-28</h3>
            <p>
                Fixed bug where one couldn't exit savegame screen. Added leaving cutscenes with space key. Added getting and setting savegame infos when quicksaving. Fixed fading in on ingame screen when reentering screen.
            </p>

            <h3>2004-04-22</h3>
            <p>
                Removed section support in ua_cfgfile, moved uw1 files check to ua_gamecfg file reader. Enhanced game strings loading by only loading string blocks "on demand", e.g. when a string in a block not available is requested. Blocks have a "lifetime" counter and some blocks are never paged out again, e.g. the block 1 with strings that are commonly used. The loader supports loading from multiple SDL_RWops structures now. Splitted basic methods of the ua_game_interface into ua_basic_game_interface, which lacks stuff not needed, e.g. for the debugger or when building an "Underworld Adventures Studio" application. Scripting now also only gets an ua_basic_game_interface pointer. Audio playlist is loaded via ua_cfgfile now. Updated player info list in uadebug to show player values again. Several other source code cleanups. Updated debian build files with those from Radoslaw and released the package.
            </p>

            <h3>2004-04-21</h3>
            <p>
                Aisha Fenton from New Zealand wants to tackle the Mac OS X port. Very nice!
            </p>

            <h3>2004-04-10</h3>
            <p>
                Released "0.9-mojito" today.
            </p>

            <h3>2004-04-09</h3>
            <p>
                Fixed most doxygen warnings and updated copyright string on modified files. Added uw-formats.txt contribution from Max Gilead. Already released the mingw32 setup packages for compiling and building the installer. And released the music pack. Currently we have two separate packages "uwadv" and "uwadv-src" to release files; maybe we should just use "uwadv"?
            </p>

            <h3>2004-04-07</h3>
            <p>
                Fixed some bugs found through valgrind warnings. My mingw32 compile crashed unexpected when first saving a quicksave savegame and then entering the savegame screen. The error was initialisation order; the info area accessed the ua_savegames_list before it was initialized. Fixed another bug when exiting savegames screen via "exit" button and immediately pressing another button. Updated Underworld Adventures manual. Added lift-off to physics code; should fix walking slopes; it's better now but still a bit jerky. wjp fixed rpm .spec file; libxslt and docbook-xsl is needed for building RPMs. Updated some texts. Fixed debug symbols for mingw32 builds when WITH_DEBUGGING is on (hopefully). My gdb still told me that no debug symbols were found. Added wish from Dominus: the manuals are now only built when doing "make installer".
            </p>

            <h3>2004-04-06</h3>
            <p>
                Updated version info; new version is codenamed <a href="http://www.webtender.com/db/drink/1435" target="_blank">"mojito"</a>. wjp added docbook building to automake Makefiles.
            </p>

            <h3>2004-04-01</h3>
            <p>
                Fixed conversation screen and enabled it. Fixed taking screenshots; also increased screenshot size to 160x100. Removed "save" button on savegame screen when entering with Ctrl+R (restore game). Fixed printing on textscroll when output is longer than a line. Savegames are now made up a bit differently. All tilemaps and objlists now have their own section, with a "tilemaps" section at start that tells how many tilemaps we have. Mapnotes are per-level now. Added notification of underworld callback about level change (to prepare new textures and stuff). Fixed player start position, now set per Lua script. Fixed traps. wjp fixed make dist. And sorry, no april fools this year :-)
            </p>

            <h3>2004-03-30</h3>
            <p>
                Moved setting 3d window viewport into ua_renderer class. Fixed text scroll printing and scrolling. Fixed looking at walls.
            </p>

            <h3>2004-03-25</h3>
            <p>
                Implemented taking screenshots for savegames. Lua: implemented most Lua C functions; they are now callable like C++ objects: "tilemap.get_info()" or "uw.print()". The trick is to put the C functions into global tables. Implemented objects "uw", "player", "tilemap", "objlist", "runes", "conv", "quest", "prop". Updated Lua code to use the new functions.
            </p>

            <h3>2004-03-22</h3>
            <p>
                Removed #if'ed-out savegame code that was once there to save unpacked savegames. The savegame file can be unpacked using gunzip anyhow. Fixed loading level maps. Updated physics code to use the stuff found in Telemachos' new <a href="http://www.peroxide.dk/papers/collision/collision.pdf" target="_blank">paper</a> (well, he released it in July, but I only found it now). Walking slopes still hangs on some occasions. Also added a test suite for physics code. Changed Lua scripting interface a bit to support looking at and using objects.
            </p>

            <p>
                Fixed savegame dialog under uw_demo; the character creation bitmap I'm using isn't available there, so I only draw some edged boxes that should do. Added Alt-key shortcuts to all controls on uaconfig.
            </p>

            <h3>2004-03-18</h3>
            <p>
                Scheduled new release date to be on 2004-04-10. There also will be a new musicpack, since I've found the "wanderer" and the "maps &amp; legends" tracks on my hard disc, done by QQits long ago (in 2002). I don't know if the tracks are finished, but surely worth listening!
            </p>

            <h3>2004-03-17</h3>
            <p>
                Started to refactor physics code. Telemachos has published a new version of his paper on collision detection and response. So far it seems he didn't change the whole concept, so it should be rather easy to implement his new ideas about swept-sphere stuff.
            </p>

            <h3>2004-03-16</h3>
            <p>
                Finished mouse action code on inventory panel. Renamed script.hpp to scripting.hpp. Fixed getting item category and ua_inventory::is_container() implementation. Added unittest.hpp/.cpp that implements a ua_unittest_run() function. It is used to run all unit tests written using CppUnit and that are registered with the test suite registry. That way we can place test classes all over the source folder (in "test" subfolders) that should test different components of uwadv. Tests should be written for every new class and/or functionality. If a bug occurs, a test that fails should be written, then the bug is fixed and the test has to succeed then. This way we can assure our code always performs correctly, event when a class implementation changes.
            </p>

            <h3>2004-03-15</h3>
            <p>
                Added is_container flag to common object properties; it indicates if an object can contain other items; the 3d barrel also has this flag, but cannot be picked up, but it can be emptied. Added armour and wearable properties. Fixed ua_inventory class by using the is_container flag, the item categories and the scripting method to combine items. Added inventory panel drawing and started to work on the mouse action code.
            </p>

            <h3>2004-03-14</h3>
            <p>
                Tested uwadv on an older system using a 3dfx voodoo banshee card; fixed drawing textures bigger than 256x256 pixels.
            </p>

            <h3>2004-03-11</h3>
            <p>
                Added text edit window ua_textedit_view. Added game events for text edit window to signal aborted or finished editing. Added entering savegame description and saving; screenshot taking has still to be done. Fixed drawing info area. Readded the transparent flag to ua_image::paste_image() to more simplify drawing. Since it's only an inline method, it should be optimized away. Implemented up/down buttons on player stats view.
            </p>

            <h3>2004-03-10</h3>
            <p>
                Fixed bug on text scroll when trying to render an empty line. Added version info resource to uwadv.exe, uaconfig.exe and uadebug.dll; when later using .msi packages we have proper version info. Fixed a bug found in STLdebug mode while initializing savegame screen.
            </p>

            <h3>2004-03-09</h3>
            <p>
                Fixed ua_debug_server_impl::get_message() implementation; A std::vector&lt;char&gt; is now used as temporary buffer to get the message string (and only when it's available at all). Added printing STLport version (when used). Removed code to load savegame format 0, since there are 2 different versions that we cannot distinguish from. Added usage of msxsl for xsl transformation used in docbook creation. Added usage of STLport's STLdebug mode when WITH_DEBUGGING is enabled. Ah, and wxWindows now is wxWidgets.
            </p>

            <h3>2004-03-08</h3>
            <p>
                Implemented updating runeshelf window from data in ua_runes. Fixed some valgrind warnings reported by wjp. Fixed bug in critter frames loading; an array was allocated with new and put in an ua_smart_ptr&lt;&gt;, which deletes the array with delete, not delete[] -> memory leaks or undefined behavior! Added experimentally omitting 1st pass when loading, bit it's still buggy and only saves about 20% loading time. Enabled with define OMIT_1ST_PASS. Added on-the-fly critter frame texture uploading; hlps greatly in cutting time while preparing a level. Modified ua_smart_ptr to have a pointer to an internal struct that holds the managed pointer and the reference count. The smart pointer now has the same size as a normal pointer. Webpage: put html template code into own file that is included where needed.
            </p>

            <h3>2004-03-04</h3>
            <p>
                Added message queue to debugger implementation. Implemented shutdown for debugger on debug server side. Client should then check for messages occasionally, either in the idle loop or via a timer. Other messages from possible code-debuggers are passed via the message queue, too. Implemented via an STL deque, where new messages get pushed at the back, and the debug client gets messages from the front.
            </p>

            <h3>2004-03-03</h3>
            <p>
                Prevented mipmap texture generation for object textures, removing the black squares in object sprites. Added preparing of all critter textures for now. In the future texture preparation will be done on-the-fly, to speed up things. Fixed render_sprite() method and added critter rendering. Finally fixed the savegame preview image rendering on savegame screen. Also added the "smooth ui" option to uaconfig. And added the website to CVS repository.
            </p>

            <p>
                I'm very sad to tell that <a href="http://www.samandmax.net/" target="_blank">www.samandmax.net</a> reported today that Sam &amp; Max 2 - Freelance Police was cancelled. Darn! That could have been the next game I've bought and played (I'm not playing much games, except for uwadv and uw1, and a bit of Diablo 2). Well, have to start up <a href="http://www.scummvm.org/" target="_blank">ScummVM</a> with the classic Sam &amp; Max then.
            </p>

            <h3>2004-03-02</h3>
            <p>
                Reimplemented text scroll; it now supports color codes used in conversation strings, e.g. \1 or \0. Added some more colors that were not used in the original games. Also added an offset value for text scroll generation. This should help in implementing a text scroll with scroll paper edges, also used in conversations.
            </p>

            <h3>2004-03-01</h3>
            <p>
                Added new ua_runes class that manages runeshelf and runebag contents. Added move arrows (below compass) handling. Movement is done by simulated key presses.
            </p>

            <h3>2004-02-29</h3>
            <p>
                Fixed compiling under linux. Bumped savegame version from 0 to 1 to differentiate between version 0.8 and 0.9. ADded listing skills value on stats panel. Added building manual using xsltproc and docbook-xsl, for mingw32.
            </p>

            <h3>2004-02-10</h3>
            <p>
                Added runebag panel drawing and checking for mouse clicks on runes. Added a panel interface class that is used in ingame screen, and later in the conversation screen as well. Scripting object is now cleaned up in the proper place. Fixed bug with black button background on the character creation screen. Fixed some other minor things. Added some more hotspots to the hotspot window in the debugger.
            </p>

            <h3>2004-02-05</h3>
            <p>
                Updated .nsi script for windows installer; NSIS is soon releasing the 2.0 version.
            </p>

            <h3>2004-01-29</h3>
            <p>
                Fixed ua_screen class bug where right mouse button clicks weren't recognized properly. They weren't used till now so this bug went undetected. Added "power gem", and added attack code so that the gem lights up properly while attacking. The ua_underworld object manages the hit power internally. Added combat keys. Fixed palette usage in save game screen, relative coordinate calculation in 3d view window, fixed loading Lua scripts in create character and cutscene screen.
            </p>

            <h3>2004-01-28</h3>
            <p>
                Added a set_palette() method to ua_image; this way it's more obviously to set the palette than assigning to the reference of the smart pointer. Fixed loading "panels.gr"; special case for panels wasn't recognized. Started reworking the panel window. And the tick() method in ingame screen is now called for every subwindow; needed for animated windows later on.
            </p>

            <h3>2004-01-26</h3>
            <p>
                Added tooltips for all controls on the underworld config utility. Tried to fix syncmail script in CVS.
            </p>

            <h3>2004-01-25</h3>
            <p>
                Added invisible 3d view class that manages mouse movement mode. Implemented mouse movement mode, too. Changed all ua_screen-derived classes to have a ref to ua_game_interface as first parameter in every ctor. The game interface reference is passed on from screen to screen then. Added user action enum values needed for object interaction, e.g. looking, using, talking to objects or getting items. For now all user actions have loose ends into the scripting class.
            </p>

            <h3>2004-01-20</h3>
            <p>
                Removed pointer to texture manager for ua_texture objects; not needed anymore. It was used for checking if the texture is already active, and glBindTexture() doesn't have to be called twice. Pretty obsolete, since OpenGL probably checks this for itself. Because of this the ua_texture::init() method and all ua_texture users were changed. Added method tick() to ua_window, to allow e.g. for animating (sub)windows. And another major change: All screens get a reference to ua_game_interface in the ctor now, since all screens have to be created with new. Because of this all ua_screen classes now have a reference to ua_game_interface as member, and not a pointer anymore. Added invisible 3d view class that handles mouse actions like mouse movement (and limiting cursor to the 3d view when mouse-moving) and icon setting and such.
            </p>

            <h3>2004-01-15</h3>
            <p>
                Added missing key for pressing buttons in menus (the return key). Fixed all sorts of bugs with the command menu, especially with keyboard usage. Added scripting pointer to ua_underworld class, so it can call scripting for various functionality. Added some more scripting interface methods and their dummy implementation for Lua. The method init_new_game() is now called when a new game is started, to initialize player, etc. Added "init-scripting" and "check-files" keywords to game.cfg parsing, but with no implementation. The first one should allow dynamic selection of scripting language, e.g. when someone (in the far future) wants to write his/her scripts in Ruby or so. Of course he/she also has to write the scripting bindings then ;-). The second keyword should specify a config file with a list of files that have to be there to successfully run the game.
            </p>

            <h3>2004-01-14</h3>
            <p>
                Applied block-comment patch from <a href="http://lua-users.org/wiki/LuaPowerPatches" target="_blank">Lua Power Patches</a>. Block comments start with --[[ and end with ]]--.
            </p>

            <h3>2004-01-08</h3>
            <p>
                Built libzzip.a and liblua.a in mingw now, to save some include paths in the uwadv compile command. Added docbook source files for uwadv and uadebug documentation. Reenabled tga texture loading. Added splash screen while init'ing the game; it reads "Underworld Adventures is loading...". Renamed "lua-script" command in game.cfg to "load-script".  Scripting is now initialized with the static ua_scripting::create_scripting() method that takes an enum with the scripting language to load. Added some ua_scripting abstract methods. Some other small changes.
            </p>

            <h3>2004-01-05</h3>
            <p>
                Added starting the debugger and related functionality. Redone and simplified debug interfacing as debug server / debug client class. OS-related stuff now goes into a debug_impl.cpp file (only for win32 for now), Linux stuff doesn't work right now (and never has, probably).
            </p>

            <h3>2004-01-01</h3>
            <p>
                ua_renderer::tick() takes tickrate, not a timespan. Added some doxygen comments.
            </p>

            <h3>2003-12-31</h3>
            <p>
                Fixed some stuff in code and documentation. Added setting texture parameter for tile and object textures.
            </p>

            <h3>2003-12-30</h3>
            <p>
                Enabled master object list loading. Added critter frames loading and moved stuff to renderer subfolder. Added preparing the critter frames as textures. Added critter frames manager (formerly critter pool). Moved 3d model manager to renderer subfolder, too. Added resetting time counting in main game loop when a frame took longer than 5 seconds. Chances are high that I just debugged the code and wanted to continue running the game (only in debug builds). Fixed stock texture loading; an off-by-one error. Changed quadtree class to have a callback function that is called when a visible tile is encountered. Fixed a bug in quadtree class where tiles at the frustum edges were not collected properly. Started to rework object and critter rendering.
            </p>

            <h3>2003-12-29</h3>
            <p>
                During winter holiday I chose to examine uw.exe further. It's interesting how the Looking Glass team built Ultima Underworld. They used Turbo C++ 1.01 (or 1.0) (available for free now at the <a href="http://community.borland.com/museum/" target="_blank">borland museum</a> for programming, but no C++ features. Some modules were compiled for overlaying (switch -Y); Turbo C++ uses Borland's VROOM (?) engine for swapping in/out code segments when code calls some functions in other overlaid modules. This time the uw team could save much conventional memory space. The segments seem to be stored in EMS memory. I played around with decompiling uw.exe with <a href="http://www.itee.uq.edu.au/~cristina/dcc.html" target="_blank">dcc</a>, but because of the calls "outside" the normal memory space into the overlay manager it obviously failed. Additionally the engine loaded the wrong library sigs (Borland 3 was identified). The decompiler engine looks promising, though, but isn't actively developed anymore.
            </p>

            <h3>2003-12-27</h3>
            <p>
                Added imports for properties, player, tilemap and map objects. Added user actions and notify calls to underworld and added method to register callback. Enabled savegame loading. Added setting game mode per command buttons.
            </p>

            <h3>2003-12-18</h3>
            <p>
                Added "smooth-ui" setting in uwadv.cfg; it can be used to get a "pixely" appearance of the user interface. Fixed crash bug in ua_screen where associated screen keymap was NULL but was accessed anyway.
            </p>

            <h3>2003-12-14</h3>
            <p>
                More or less fixed compiling the character generation screen; that one surely needs a redo. Most buttons don't redraw their background properly.
            </p>

            <h3>2003-12-10</h3>
            <p>
                Introduced new class ua_debug_server; no more work on the debugger yet - the changes were only done to complete the uwadv game class code (I don't expect changes here for some time; all code should be pretty encapsulated).
            </p>

            <h3>2003-12-03</h3>
            <p>
                Revised the README.dev.txt document; it now has only startup information; the one and only source code documentation is the doxygen docs now. Improved docs on the "base" module.
            </p>

            <h3>2003-11-26</h3>
            <p>
                Ingame zpos is now in range [0; 128] as the objects are, too. They just didn't use that much precision in the uw1 code for tile positions. Enabled slight fog, which somewhat hides the far clipping plane. Added vitality and mana flasks, gargoyle eyes, text scroll, runeshelf window and active spell area. All window work, but some "update" code and actions has to be written.
            </p>

            <p>
                Added starting music when (re-)entering the screen. Fixed playlist loading (had audio turned off during development, so I didn't notice this until now). Audio tracks can now referenced with an easier-to-remember enum.
            </p>

            <h3>2003-11-25</h3>
            <p>
                Added base class for all ingame_orig windows. Added compass window. Hopefully finally fixed ua_ingame_quad drawing; there still were errors with some window sizes. Nicely documented the class.
            </p>

            <h3>2003-11-20</h3>
            <p>
                Started reimplementing original ingame screen. Revised ua_keymap and removed unneeded functions; the mapping of keymod values and key enums were reversed. Also fixed keymod search: the fact that the user usually only presses one ATL or CTRL key wasn't recognized when searching keys. Some other minor changes. The dot tool is now used with doxygen (if installed) to generate some nice include and collaboration graphs.
            </p>

            <h3>2003-11-10</h3>
            <p>
                Disabled tools by default; they surely won't build :). Added geometry provider class, which is responsible to generate textured triangles for the collision detection/response and the renderer class. An idea would be to use OpenGL display lists for tile triangles (that can be updated, e.g. for moving tiles) that can be stored as tile "metadata"; when rendering the display list indices can be collected, sorted by texture id and thrown at OpenGL in an efficient manner then. Fixed floor texture loading (passed wrong filename to loader function). Moved texture manager to implementation class and added a prepare_level() function that prepares textures and could to the above mentioned display list preparation.
            </p>

            <h3>2003-11-06</h3>
            <p>
                Added a find_key() method to ua_keymap to search for the key enum for a given pressed key. Maybe this is now the most important function and the map association can be reversed. The function is used in ua_screen::process_event() to handle key events and finally call overloaded ua_screen::key_event() methods. The rest of keyboard handling is just a big switch statement with the key enum value.
            </p>

            <p>
                I'm also implementing an ua_ingame_new screen to test some ui/render classes and concepts. The screen might finally become the new user interface screen.
            </p>

            <h3>2003-11-03</h3>
            <p>
                Added some convenience functions to ua_window. More work on the savegames list window.
            </p>

            <h3>2003-11-02</h3>
            <p>
                Some work on uw2 critter animation files decoding.
            </p>

            <h3>2003-10-22</h3>
            <p>
                Fixed cutscene view screen and re-enabled the introduction. GL_BLEND is now used when rendering mouse cursor. The GL_BLEND state is restored after rendering again.
            </p>

            <h3>2003-10-21</h3>
            <p>
                Fixed acknowledgements screen; it now uses one cutscene image quad and a "fadeout" image quad with the image to fade out, which saves one image quad and a 512x256 texture.
            </p>

            <h3>2003-10-20</h3>
            <p>
                Added border "feature" to ua_image_quad to get seamless sub-windows. When using split-textures (only on older graphic cards) there still is a small seam.
            </p>

            <h3>2003-10-01</h3>
            <p>
                Fixed image quad rendering, and two split-textures are now only used when the OpenGL driver reports a max. texture size of 256 or less.
            </p>

            <h3>2003-09-26</h3>
            <p>
                Changed the ua_palette256 type to be a class and not a typedef anymore. This beautifies the code to create, clone and rotate palettes a lot. Fixed mouse cursor rendering.
            </p>

            <h3>2003-09-24</h3>
            <p>
                Try to fix image quad class; textures were only drawn white, since no texture params were set via glTexParameteri(). Updated splash screen and start menu to use the new ua_image_quad and ua_cutscene implementation. Added check for wxWindows, later used for uadebug. Mostly fixed linking.
            </p>

            <h3>2003-09-23</h3>
            <p>
                Try to fix palette typedef usage. Fixed mouse cursor class, which now is also derived from ua_window. Other small changes.
            </p>

            <h3>2003-09-18</h3>
            <p>
                Object images are now put into stock textures; they previously were hold in an image list, and before that they were copied into two large 256x256 textures. Moved texture loading, cutscene loading and frame extraction to import folder.
            </p>

            <h3>2003-09-17</h3>
            <p>
                Redesigned the ua_image class, replaced ua_image_list with a STL vector of images, rewritten image loading. Redesigned ua_texture and ua_texture_manager class, and fixed texture loading. Added image manager that manages loading and holds game palettes (they previously were managed by the ua_texture_manager). Changed base class of ua_image_quad to ua_window, since this should become our base window "control" for basic image rendering. Specialized windows such as scrolls and the like can be derived from this class then. Other small changes.
            </p>

            <h3>2003-09-15</h3>
            <p>
                wjp fixed the autoconf/automake files for the new directory structure, since the Lua sources were moved by SF staff. Moved files only need to be updated in Makefile.common anyway.
            </p>

            <h3>2003-09-10</h3>
            <p>
                Improved source documentation.
            </p>

            <h3>2003-09-09</h3>
            <p>
                Opened a support request to move the lua source to a subfolder of the "script" folder. Re-added custom language pack loading. Re-enabled cutscene, acknowledgements and savegame screen. A lot more small changes and updates.
            </p>

            <h3>2003-09-06</h3>
            <p>
                Added Lua script class, derived from a scripting base class. Added doxygen grouping to categorize class documentation into different "modules".
            </p>

            <h3>2003-09-05</h3>
            <p>
                Added fading helper class and used it in start splash and start menu screen. Fixed acknowledgements screen. Character creation and cutscene view will be harder to fix, since they use Lua, which is going to go into the scripting folder.
            </p>

            <h3>2003-09-04</h3>
            <p>
                Redone mouse cursor class to be derived from ua_window. Added handling of mouse events via the new ua_window member function mouse_event(). The function is only called if a mouse event occurs in the window the mouse is over. The mouse cursor class is used in start menu screen.
            </p>

            <h3>2003-09-02</h3>
            <p>
                Converted uwadv menu screen and start splash screen to use the new ua_screen base class. Fixed some errors and added a texture manager object to the renderer class to have access to the texture manager. wjp sort of fixed some autotools related files.
            </p>

            <h3>2003-09-01</h3>
            <p>
                Added game interface class that is similar to the old game core interface, only better :). Added some more main game loop stuff and added back game strings loader to fix linking (at least for me, hehe).
            </p>

            <h3>2003-08-28</h3>
            <p>
                Moved most files to their new places; only did header and comment changes and commented out stuff that refuses to work. Thought about an game interface class similar to the core class that glues together game objects and the underworld objects. Scripting will become a separate component and the Lua stuff should be capsulated so that in principle one could choose what scripting language to use. The game interface would also manage the scripting - game objects interfacing.
            </p>

            <h3>2003-08-25</h3>
            <p>
                Moved font class to ui folder and changed the way stuff from uw1 and uw2 are loaded now. There is a general import class (for loading common formats) and two specialized classes for uw1 and uw2 that can be used to load the various resources.
            </p>

            <h3>2003-08-24</h3>
            <p>
                Removed some -Wall warnings, added some GPL headers to automake files and some other small changes.
            </p>

            <h3>2003-08-22</h3>
            <p>
                Continued working on the ua_window and ua_screen base classes. Set up SDL window creation and main game loop again; some stuff is still commented out.
            </p>

            <h3>2003-08-21</h3>
            <p>
                Redone the main() function, which is now os-independent. Commented out most of the ua_uwadv_game (previously ua_game) object and fixed win32 implementation. os-specific objects are created using the ua_game_create() function.
            </p>

            <h3>2003-08-20</h3>
            <p>
                Started redoing the user interface classes, having a ua_window and ua_screen base class. ua_window is a rectangular area on screen, can draw itself and can process messages. ua_screen can do all that and additionally manage ua_window subwindows. drawing and event messages are routed to the subwindows, too.
            </p>

            <h3>2003-08-19</h3>
            <p>
                Started to reorganize the audio folder a. Renamed some classes, files and added comments where needed. Introduced (or better, renamed the ua_audio_interface to) the ua_audio_manager class that now handles all audio stuff.
            </p>

            <h3>2003-08-16</h3>
            <p>
                Committed some left-over files to the repository and set a tag "refactoring_start_20030815". Started to reorganize the whole source tree into more logical components that shouldn't depend on other components, or at least only on one or two. There also could be unit tests for each of the components. Also improving comments and code style while moving around files.
            </p>

            <p>
                Moved the config file base class, files manager, savegame class, settings, math classes and the utils to a "base" folder. Made some classes independent of all other classes, e.g. Lua script loading in the files manager or savegame info filling from ua_player objects. At the moment the project doesn't compile :)
            </p>

            <h3>2003-06-30</h3>
            <p>
                Done some work on the critter workbench test project. There now is a red dot representing the currently selected (and later evaluated) critter. Adding pathfinding should be the next task, and also a mode to check the pathfinding results. Should be able to borrow some code from Exult or so :)
            </p>

            <h3>2003-06-24</h3>
            <p>
                Added a pathfinding skeleton class to have an overview what the pathfinding algorithm interface should look like. Also started a test project, a "critter AI workbench", a 2d top-down look on a level that can be used to evaluate AI and pathfinding code.
            </p>

            <h3>2003-06-23</h3>
            <p>
                Thought about a new set of Lua functions to simplify critter AI, and to help John McCawley getting into coding some AI. In the last days I tried around creating a msi package (windows installer service) for Underworld Adventures, but hand-editing the many tasks is pretty complicated. Plus I have to download almost the entire Platform SDK, which comes as whopping > 300 MB. <a href="http://mwi2xml.sourceforge.net/" target="_blank">msi2xml</a> would definitely simplify a bit of the work.
            </p>

            <h3>2003-06-08</h3>
            <p>
                More or less fixed the huge loading times for critter animation frames. Frames are loaded into a pre-allocated memory space instead of inserting thousands of ua_image objects into std::vector containers. Also changed the ua_critter code to support animation frames with different texture sizes, but this isn't used yet (code was committed on 2003-06-23). Uploading all animation frames (about 36 MB worth of 32-bit texture data) also takes pretty long. Should be enough when only the current set of frames for an animation currently used has to be uploaded to OpenGL. Worth a try.
            </p>

            <h3>2003-05-20</h3>
            <p>
                Added some more screenshots showing 3d objects and wall decals.
            </p>

            <h3>2003-05-15</h3>
            <p>
                Things might get slower a bit (I got a job). On the other hand, no :) I'm playing around with several things: found a Lua debugger (<a href="http://www.xtgsystems.com/linux/lua/titmouse.php" target="_blank">Titmouse</a>) with source that shows me how to do the Lua debugger in the Underworld Adventures debugger. Although uwadv has grown too big with time to start it to quickly verify some things. A solution would be a mini-uwadv that just calls the uadebug and implements some callback commands needed to get it running.
            </p>

            <p>
                Another thing I'm looking forward to do is to improve critter animation frames loading. Currently it takes almost forever compared to the last release. The main reason for that is that a ua_image object is constructed and copied twice for every frame loaded, which could be improved. And finally Servus did a door texture, which could be plugged into the texture manager easily by having another config file in the game's uadata folder.
            </p>

            <h3>2003-05-14</h3>
            <p>
                Rewrote the quadtree tile culling stuff using the ua_vetor2d class and throwing out all unneeded stuff. Added another render() function to ua_renderer that receives all player dependent variables; the ua_renderer class could also be used for map viewer now. Changes were made to support the uadebug tilemap view.
            </p>

            <h3>2003-05-13</h3>
            <p>
                Invented a new system to process messages, especially mouse messages, based on areas, implemented in the template class ua_message_processor. The user of the class can register member function pointers to handler functions, together with the area definition. Processing for keys in a ua_keymap is planned, too. The new system should make the whole process of treating mouse messages much easier.
            </p>

            <p>
                Reimplemented start menu dialog using the new message processor as a proof of concept. Should improve handling all those mouse events in ingame screen, too.
            </p>

            <h3>2003-05-11</h3>
            <p>
                radekg2 added all files needed for debian package building. Cool thing!
            </p>

            <h3>2003-05-05</h3>
            <p>
                Added ua_vertex3d struct and changed how ua_triangle3d_textured is implemented. Added a polygon tessellator class based on gluNewTess(), gluDeleteTess() and gluTess*() functions. Changed loading and rendering builtin models to use the polygon tessellator. Some models still look strange, though.
            </p>

            <h3>2003-05-03</h3>
            <p>
                Added experimental "tilemap view" to underworld debugger. It uses the same rendering functions as the game but a seperate ua_renderer object. Currently resizing the frame window results in lockups. Added mutex implementation for locking the underworld object (lock/unlock was an empty call 'till now), but it doesn't help either. Have to investigate further.
            </p>

            <h3>2003-04-30</h3>
            <p>
                Added Radoslaw Grzanka "radekg2" to the project; he is responsible for debian packaging. Released his .deb package for the 0.8a-hot-chili release. Started discussion with John McCawley about AI implementation.
            </p>

            <p>
                Added dumping to the builtin model loader, to be used in uwdump. Removed the viewer part of the modeldecode.cpp, which is now implemented in uwmdlview. Added support for uw2 level dumping to uwdump.
            </p>

            <h3>2003-04-29</h3>
            <p>
                Opening container can now be done in any game mode, not just default. Fixed a bug with the priority cursor code, fixing all 3 bugs uwadv currently has. Done a win32 binary release 0.8a-hot-chili.
            </p>

            <h3>2003-04-27</h3>
            <p>
                Fixed bug <a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=722818&amp;group_id=50987&amp;atid=461662">#722818</a> submitted by Radoslaw Grzanka (radekg2).
            </p>

            <h3>2003-04-24</h3>
            <p>
                Implemented "a_delete object trap". Added "can be picked up" flag from common object properties, preventing the user from picking up some objects. Bridges rendering are fixed temporarily by just drawing the bridge square. Also fixes collision detection. Have to find a way to subdivide the concave polygons delivered by the builtin models decoder. Omitted rendering of some objects not 16x16 and thus not available in the object images list.
            </p>

            <p>
                Documents were updated for the release. Added some more hotspot points to the debugger's hotspot list. And a lot more small fixes. As I tested the release with uw_demo, the game crashed because no builtin models could be loaded; added the model positions for the uw_demo.exe build I have. Fixed crash when changing to next level in uw_demo, e.g.  by teleport trap in the gray goblin's area. An exception is now generated. Fixed priority cursor functionality in ingame screen. Fixed textscroll when input line gets too long. Phew, a pretty long list o' stuff.
            </p>

            <h3>2003-04-16</h3>
            <p>
                Added an underworld builtin models viewer and rewrote the models decoder to not subdivide the (often concave) polygons. Disabled collision detection for bridges temporarily. Moved the ua_model3d implementation classes to own header file. Fixed the luac Lua compiler; it had some stub functions to not pull in all liblua functions.
            </p>

            <p>
                Fixed the #undef main part of most tools; the reason for most undefined _main macros was the fact that the main function has to have the exact signature "int main(int argc, char* argv[])".
            </p>

            <h3>2003-04-15</h3>
            <p>
                Added Lua functions to access the inventory. Added getting objects from the underworld, without checks for distance and get-able objects for now. Added inventory/container weight calculation. Some containers have space limits.
            </p>

            <h3>2003-04-13</h3>
            <p>
                Fixed object list view in uadebug and added a hotspot list feature to immediately and conveniently jump to important spots in the underworld. Updated doxygen config file for the new 1.3 release.
            </p>

            <h3>2003-04-10</h3>
            <p>
                Added map notes class to store map annotations. Added texture animation for lava and water textures, which is now a simple thing due to the new texture manager implementation. Extended the flags to 16 bit, since it may have to hold bridge texture id's. Added support for trigger-trap-trigger-trap-like effect chains.
            </p>

            <p>
                Modified the Lua library in such a way that it can parse hex digits, like 0x016e, which greatly simplifies work with item_id's throughout the code. Maybe I should send the <a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/uwadv/uwadv/source/lua/lua-hexdigit-patch.diff?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">hexdigit patch</a> to the lua-users list or so. Modified all Lua scripts to use the new format when possible and adequate. Moved the Lua and zziplib library files to the uaopt project to get some space in msvc and optimized code.
            </p>

            <h3>2003-04-09</h3>
            <p>
                Moved "look at" and dump related functions to own .lua file. Moved looking at walls to Lua function. Rewrote texture manager to better handle animated textures and further stock textures for switches, levers, doors, bridges, etc. Additionally it isn't required anymore to call ua_texture::use() before upload()ing textures to OpenGL. All stock textures used in rendering must be prepare() when resetting wall/floor textures. For switches/levers/pull chains and wall writings the correct texture is now used. Added plaque reading.
            </p>

            <h3>2003-04-08</h3>
            <p>
                Fixed "look at" description for all objects that can have a "belongs to ..." description printed; it is determined via the common object properties table in Lua.
            </p>

            <h3>2003-04-06</h3>
            <p>
                Rewrote map import, as SDL_RWFromFP() doesn't work in debug builds, since it tries to use the FILE* handle from the release runtime library (MSVCRT), but it was opened in the debug one (MSVCRTD). The rewrite is cleaner now anyway.
            </p>

            <p>
                As textures have to be "absolute" in the uwadv engine (don't have the mapping available ingame), I should add texture resolving for all items that need it; "special tmap object" is already done. Mostly implemented "special tmap object" rendering, too.
            </p>

            <h3>2003-04-04</h3>
            <p>
                My "Mysteries of the Abyss" clue book for Ultima Underworld 1 arrived from US today! It has a fairly comprehensive description of all important spots of all the places in the underworld, as well as more technical infos about the gameplay. It really helps developing uwadv further. (thanks Beavis!)
            </p>

            <h3>2003-04-01</h3>
            <a id="april1st" name="april1st"></a>
            <p>
                Did an april fools joke today. I announced this text on the main news page:
            </p>

            <p>
                <i>
                    2003-04-01 - Fantastic news!<br />
                    I'm very proud to announce some fantastic news today! The Underworld Adventures Team got the original sourcecode to Ultima Underworld 1 and 2 today! Doug Church himself, the lead developer for both games, sent a zipped file with the game's source code. And the best is: we, the team, offer you the download, too (see below).
                </i>
            </p>

            <p>
                <i>
                    With these fantastic new happenings, I estimate that the Underworld Adventures project can be finished in about one or two months, filling in all the missing parts from the original games. Please visit this page in the next few days for another announcement of detailed plans how to accomplish this. Meanwhile, get the original Ultima Underworld source code <u>here!</u>.
                </i>
            </p>

            <p>
                The link pointed to a page with this text:<br />
                <i>
                    Happy April Fools Day to everyone!<br />
                    Sorry for that :-) but expect a release with some (not all, heh) new stuff in about one or two weeks. Really!
                </i>
            </p>

            <p>
                Added "toolsinstall" target for Dominus to install the tools.
            </p>

            <h3>2003-03-31</h3>
            <p>
                Added uw2 .ark files decoding using a SDL_RWops struct. Level tilemap and object list importing already works. Disabled some things for uw2 games to get it up and running, but I don't intend to work on this for now. Added "used" flags; used in "empty" map slots in uw2. mapdisp and map3ds do support uw2 levels from here on. Added loading of a language specific strings file, from %prefix%/lang.pak, to support text string translations in uwadv. Added Lua functions to access the common object properties.
            </p>

            <h3>2003-03-27</h3>
            <p>
                Jammet contacted me today and asked about the screenshots with the translated conversation texts and offered help in translating more of the game. Supporting custom-loaded game strings .pak files should be fairly easy.
            </p>

            <h3>2003-03-26</h3>
            <p>
                Added common object properties decoding to uwadv and uwdump.
            </p>

            <h3>2003-03-25</h3>
            <p>
                Implemented the move trigger and the teleport and text string traps; level changing works now. Strings are printed a bit too often (each time the trap is set off :) The is_quantity flag is always set for triggers (seems to be a bug/not necessary); uwadv's object list loader fixes this. Added "using" of "world" objects to get use triggers to work. Added look trigger handling, too.
            </p>

            <p>
                Disabled rendering of invisible flagged objects in release mode. For all objects the zpos field is used; bats, etc. and other objects are in proper height now. Added rendering of switch/button/pull chain/etc. decals. Quest flags are now saved in savegames. Fixed selection/picking for decals.
            </p>

            <h3>2003-03-22</h3>
            <p>
                Sir Cabirus also sent a bunch of saved games from the original game that start at each level of the underworld. Good to have it around, in case I have to verify game-related stuff.
            </p>

            <h3>2003-03-20</h3>
            <p>
                wjp fixed compiling of the uwdump tool for Linux systems.
            </p>

            <h3>2003-03-19</h3>
            <p>
                Finally I can go online (with a dialup, at least) again. Updated uwadv to have the object coordinate fields in integer again (some traps do need the field's value) and added the newly found npc fields to the object class and the Lua table (objlist_get_info). Found a new remake project, <a href="http://nuvie.sourceforge.net/" target="_blank">Nuvie</a>, a remake similar to Exult, but to play U6 engine-like games (U6, Martian Drams (yeah!) and Savage Empire). After hacking the mingw32 makefile away, it even compiled and linked. Have to try out later when I have a martian savegame somewhere.
            </p>

            <h3>2003-03-18</h3>
            <p>
                <a href="http://www.sircabirus.com/" target="_blank">Sir Cabirus</a> made a special offline version of his walkthrough and sent it to me, to always have it available on hard dist. Nice thing!
            </p>

            <h3>2003-03-17</h3>
            <p>
                Finally figured out the place where npc variables are stored in the conversation memory for use as "imported globals". Could guess quite some npc_* variables in the npc data area. I recently modified uwadv that the "zpos" field is stored as a double - seems that I have to change this field back to int, since some traps uses the field. The same with "xpos" and "ypos" fields. And it seems that tilemaps store the floor height in a lower bit resolution than used in the game, only using 5 bits. They are shifted left to use 7 bits ingame, just as the normal item's "zpos" field also has.
            </p>

            <h3>2003-03-15</h3>
            <p>
                Found out more stuff using uwdump and the decoded uw.exe:<br />
                * the speaking door in level 6 (tile coords=04/02) is hard-wired in the uw.exe; a temporary npc object is allocated and the npc_whoami field is filled with the conv. slot of the door<br />
                * a common function for link field extraction for tilemap index, normal chain links and special links are used, since the fields all have the same bit positions (bits 6..15 of a 16-bit integer value)<br />
                * uw seems to use a simple random number generator (don't know if it's the runtime library's one) with the equation rand = (rand_last * 0x015a4e35)+1
            </p>

            <h3>2003-03-12</h3>
            <p>
                Started to write an "uwdump" program to extract and dump all infos from uw1/2 in text form. It currently features level map and master object list decoding.
            </p>

            <h3>2003-03-10</h3>
            <p>
                started disassembling and commenting the uw.exe source using a freeware version of IDA Pro, 4.1 (a bit older than the current freeware version, but it supports non-PE executables, too). Found out quite some interesting things:
            </p>

            <p>
                * the game is written mostly in C, even though Turbo C++ 2.1 was used<br />
                * game strings needed during gameplay are loaded/unpacked on-the-fly, the strings.pak is always open<br />
                * a temporary lev.ark and bglobals.dat is stored in Save0 folder during gameplay<br />
                * internal underworld level indices are 1-based; 0 means "current level"<br />
                * pit and combination traps are not implemented<br />
                * ward and tell trap seems to do the same<br />
                * there's a "debug printf" function, but it has no implementation (release build)<br />
                much more things ...
            </p>

            <h3>2003-03-03</h3>
            <p>
                I'll be unavailable online for some days, as I'm relocating to another city. I'll continue doing stuff for uwadv in the meantime.
            </p>

            <h3>2003-02-25</h3>
            <p>
                Modified the master object list in the underworld debugger to hold all values in a string array, in spite of getting every value from the game itself when the list control has to be updated. The user has to "update" the list to be the current one when editing it. Reordered columns. Unfortunately I cannot catch a double-click on a particular list cell (e.g. to jump to a linked object). Added a AddFrameMenus() method to the main frame window to set common menus to child frames. Added menu items for the master object list frame to save object list to a .csv file, and added the possibility to change the level of which the object list is shown.
            </p>

            <p>
                I changed back the return types of all handle_event() and mouse_action() methods, since it didn't really make sense to have the info if the event was handled. Also added saving of ua_object objects to also store inventory objects easily. In Lua, the real npc variable names (e.g. "npc_xhome", etc.) are set instead of using a "data" array. For this I have to find out most of the important variables in the npc info, though. Disabled the inventory items placed into inventory for release builds. Added inventory saving. Fixed conversations, not that we don't have a "data" array. Fixed Lua dump_objinfo_table() function. Wow, done a lot this day!
            </p>

            <h3>2003-02-24</h3>
            <p>
                Added experimental "special tmap object" decal rendering using glPolygonOffset(), but selection doesn't work quite right with it (as mentioned in the manual). should probably render the decal differently when using selection mode. Object zpos is now in tilemap z coordinate range for better coordinate handling.
            </p>

            <h3>2003-02-21</h3>
            <p>
                Added "separate mesh" functionality to map3ds, for the Morrowind Underworld project.
            </p>

            <h3>2003-02-19</h3>
            <p>
                Found out what skills.dat contain; it lists the skills set up during character creation. Still not sure about chrgen.dat
            </p>

            <h3>2003-02-18</h3>
            <p>
                Modified the screens base class to have a base class for controls, too. The base class does the mouse action event stuff now, as well as the mouse-on-area functionality. Improved trace output of most screens, too. OpenGL window is cleared when doing screen init, suspend, resume or done. Modified replacing screens (resume and suspend of the last screen was called, which is unneeded an time-consuming).
            </p>

            <p>
                Factored out the panel on the right of the user interface - the inventory/stats/runebag control. Added hack to get bridges to work, rendering and collision detection wise. Had to use an ugly hack to access the model manager from the physics code (static pointer to mgr). Also started to rewrite the uw-formats.txt file in a more organized manner.
            </p>

            <h3>2003-02-16</h3>
            <p>
                Paths are not required anymore to have slashes at the end (proposed by Copernica). yot reported that the last release freezes at him when clicking on "Introduction". Couldn't reproduce the bug here.
            </p>

            <h3>2003-02-15</h3>
            <p>
                The UW1 Morrowind mod people (they use some tools from uwadv for resource extraction) announced their <a href="http://users.tpg.com.au/ron3sun/main.htm" target="_blank">homepage</a> to me today. Looks pretty!
            </p>

            <h3>2003-02-14</h3>
            <p>
                Finished savegame screen today, although the user cannot scroll when more than 17 savegames are displayed (hmm, maybe the up/down buttons from the inventory could be reused). I've put up a screenshot (also one with the debugger shown). Also introduced usage of a "game.cfg" file that contains all per-game configuration settings, etc. Currently we only have a "uw1" game, but adding "uw2" or custom games will be much easier later.
            </p>

            <p>
                The debugger interface and underworld access API classes now get tick() calls every tick to process debug stuff on the main game loop thread. This was necessary to reload all textures when the map level is changed from the debugger. OpenGL can only work with the resource context when it's used from the same thread that it created. Other uses would be a "notify" system that "sends" messages back to the debugger, e.g. when a breakpoint is released. The debugger then could "query" a stack or deque of "events" from the main game thread.
            </p>

            <p>
                Ah, and added pausing the underworld. Oh, and fixed the lua_savegame_* functionality. And disabled the "level up" and "level down" keys for release builds. I hope level changing by triggers/traps is possible 'till the next release.
            </p>

            <p>
                Darkwarrior from <a href="http://www.stygianabyss.com/" target="_blank">StygianAbyss</a> sent word that the TTLG network currently is down due to hardware issues. Hope everything is up soon again. Here's a <a href="http://www.wingedspirit.net/ttlgstatus/" target="_blank">status page</a>.
            </p>

            <h3>2003-02-13</h3>
            <p>
                Finally Gamespydaily and RPGPlanet figured out that uwadv has a new release. Unfortunately they write that uwadv would be an "unauthorized" remake of ultima underworld 1. I don't know who should authorize me to write a game and engine that happens to look the same as uu1 and imports all game resources by chance, as I nowhere use the Ultima trademark (which Origin or EA owns) other to describe the project's meaning.
            </p>

            <p>
                The people at <a href="http://www.rpgcodex.com/" target="_blank">RPGCodex</a> also discovered uwadv. They even added the screenshot with the "abyss cubus" :) And yes, people seem to still have Voodoo3's :) Another <a href="http://www.jokerbone.com/archives/2002/11/08/000766.html#000309" target="_blank">site</a> (a blog writer) even titled his article "Mages get the chicks..." :)
            </p>

            <h3>2003-02-12</h3>
            <p>
                Continued to write and integrate the savegame screen into uwadv. Also wrote code to do a screenshot from the game, to use either as screenshot to save to disk or in the savegame preview, to show off where the player was when he/she saved.
            </p>

            <p>
                Also played with mapdisp a bit, adding an option to import all levelmaps at once, showing the "borg cubus" from the image some days below this. Also added a screenshot option to take hi-resolution screenshots. The idea cam from a <a href="http://www.delphi3d.net/listfiles.php?category=6" target="_blank">Delphi3d</a> <a href="http://www.delphi3d.net/download/hiresshot.zip" target="_blank">tutorial</a> about hires render screenshots. The projection matrix isn't that correct from what the user sees in the image, but it produces nice results. One could even print out the 20MB of 4x4 tiled (2560x1920) underworld levels as poster or something :)
            </p>

            <h3>2003-02-11</h3>
            <p>
                Released the "Muffin" today. Only posted news to freshmeat.net for now. Also started working on the unified savegame load/save screen, using most UI elements from the character creation screen.
            </p>

            <h3>2003-02-10</h3>
            <p>
                Fixed "make dist" today and added a configure option --enable-uadebug (which currently doesn't do anything) to later enable building the Underworld Debugger.
            </p>

            <h3>2003-02-04</h3>
            <p>
                Fixed texture paths inside the .wrl files, since file names are case-sensitive when opening from the resource file (and on Linux).
            </p>

            <h3>2003-02-03</h3>
            <p>
                Had the chance to try uwadv on a Diamond FireGL 1000 Pro card (seems to be manufactured 1998 or so). It's an AGP card and has 8MB memory. In windowed modes textures are very blurry and tiled textures have very obvious seams. According to the OpenGL stats it only supports 128x128 sized textures in this mode (but 16 light sources - my current card even can't do that). In Fullscreen mode things are slightly better - textures up to 512x512. Frame rate is still bad. 5 fps at the animated underworld logo and about 6 fps in the first hallway. Well, it was a good card for its time.
            </p>

            <h3>2003-02-02</h3>
            <p>
                Added a menu item to the underworld debugger to disable underworld processing (since most edit actions only make sense when the game is halted).
            </p>

            <h3>2003-01-30</h3>
            <p>
                Added a child frame to show the "master object list" in the debugger. Should be easy to do in wx.
            </p>

            <h3>2003-01-29</h3>
            <p>
                Replaced the way the debugger accessed infos of the underworld object with a new one. The old one was done using a class, and that wasn't that portable between msvc and mingw. The new system uses a single callback "command" function that the debugger can call to get infos. It can be given a command, a command type and two in/out-parameters using a union inside a struct (should be portable enough). Tried to get the wxWindows stuff to compile on mingw32, but there still are some problems. Added a "Underworld Adventures features" check to the uaconfig program.
            </p>

            <h3>2003-01-28</h3>
            <p>
                Added support for translation, rotation and scale keywords from vrml. Don't know if I handle them properly. Enough with 3d models for now.
            </p>

            <h3>2003-01-20</h3>
            <p>
                Introduced a static library for the tools where all needed files from uwadv get in. I already had such a thing for msvc, but added it for mingw32 (and Linux), too. Added the 3ds import code used for testing, but it's not used in uwadv (it needs lib3ds). Added some more objects from Servus to the CVS, as well as a .wrl file viewer. Added decoding to tga images into animview (used in another remake project). And finally fixed a tiny resource leak in the code loader (file was not closed).
            </p>

            <h3>2003-01-17</h3>
            <p>
                More work on the model importing. Added a tga file importer from one of my previous projects.
            </p>

            <h3>2003-01-16</h3>
            <p>
                Wrote a rather limited <a href="http://astro.temple.edu/~john43/flex/" target="_blank">flex</a> lexer to read in .wrl (vrml97) files and added derived ua_model3d class. Added some of Servus' models to CVS to incorporate into uwadv. Also moved the debug interface pointer to the game core class, to have it on a more centralized place. Should come up with a new debugger access api and uadebug application soon.
            </p>

            <h3>2003-01-13</h3>
            <p>
                More fixes for generic conversations. More npc attributes are stored in the data array, too. Npc attitude is now output when looking at one.
            </p>

            <h3>2003-01-08</h3>
            <p>
                Fixed generic portraits in conversations (there is on portrait for every item_id). The conversation screen now gets level and object list pos of npc to talk to (needed for all sorts of things, e.g. inventory of npc, remove_talker, etc.). Fixed wall/ceiling/floor textures after conversation (texture manager reloaded wrong set of textures). Thought about how to import Blender3d files and found blend2cs (blender to crystal space converter) on <a href="http://projects.blender.org/" target="_blank">http://projects.blender.org/</a>. Servus joined #uwadv and later modeled some models for uwadv and low. <a href="http://www.geocities.com/russell_figowitz/images/" target="_blank">Here</a> are some of his images.
            </p>

            <h3>2003-01-07</h3>
            <p>
                Some changes on the uninstaller (stdout.txt was not deleted). Added decoding of weapons.dat in th hacking folder, but don't know yet what it all means.
            </p>

            <h3>2003-01-04</h3>
            <p>
                Telemachos changed gravity a bit (first CVS commit in the new year!).
            </p>

            <h3>2003-01-03</h3>
            <p>
                Changed uwadv-devel list configuration so that to post one have to be subscribed. Should prevent spam mails on the list.
            </p>

            <h3>2003-01-01</h3>
            <p>
                Dark-Star, a regular visitor of #uwadv started <a href="http://sourceforge.net/projects/exfinity/" target="_blank">Exfinity</a>, a remake of Baldur's Gate's (and other games') Infinity engine. He also has a channel on freenode, #exfinity.
            </p>

            <h3>2002-12-25</h3>
            <p>
                wjp found out there is a bug in automake 1.6.1 that installs the ua-lowercase-all.pl script to the wrong place. Using 1.6.3 should fix that.
            </p>

            <h3>2002-11-30</h3>
            <p>
                Fixed the map3ds conversion program today, and also did a nice "all-levels-in-one" 3ds which looks quite cool. Here's the <a href="http://uwadv.sourceforge.net/index.php?page=image&amp;image=devel/all_levels.jpg">image</a>. Wrote a test program to show the uw models extracted from the exe, but the polygon subdivision is wrong for now. Moved some non-sourcecode files from the "linux" and "win32" to separate folders in the main project dir. Also found out that the last texture in the ceiling texture mapping in lev.ark actually is the ceiling texture.
            </p>

            <h3>2002-11-29</h3>
            <p>
                Fixed the conversation screen bugs. Added more imported function implementations. Sethar strongarm should work now (he can be asked for some keywords). Conv. text replacements like @SS1 or @GS8 should work, too. Added music playback for conversations, so that QQtis can work on Maps &amp; Legends (it's also used here).
            </p>

            <h3>2002-11-27</h3>
            <p>
                Found out more flags and values in the NPC extra data, thanks to Coren. Added quest flags to the underworld object (basic quests like Ketchaval / Retichall) work now. Fixed BRA opcode (target address off-by-one error).
            </p>

            <h3>2002-11-26</h3>
            <p>
                Started working on conversation screen. Conv. VM needed some fixes and most imported functions are missing, but basic conversations via the main "babl_menu" function works. Used the ua_image_quad class in ingame screen, too. Underworld Adventures is now mentioned in the rec.games.computer.ultima.* FAQ.
            </p>

            <h3>2002-11-25</h3>
            <p>
                Added ua_image_quad class to encapsulate rendering of big images using only textures up to 256x256 (functionality was moved from the ua_textscroll class). Used the class for 2d images in text scroll, splash screen, as base class for ua_cutscene, acknowledgement screen and the start menu. uwadv should be Voodoo3-safe now. Also tried to unpack uw2 conversations (they used a simple compression scheme this time).
            </p>

            <h3>2002-11-23</h3>
            <p>
                There weren't as much hits from news pages as expected, but oh well. Decided to use shorter release periods, while working on single features at a time.
            </p>

            <h3>2002-11-21</h3>
            <p>
                Today's release day! We chose "rotworm stew" (item_id=0x011b) as code name, to have a somewhat more ultima related release name this time (Michael Maggio once complained on his news site <a href="http://reconstruction.voyd.net/" target="_blank">Ultima: The Reconstruction</a> about that :-). uwadv is also announced at freshmeat.net, which I expect to come the most site hits from.
            </p>

            <h3>2002-11-20</h3>
            <p>
                Added looking at objects in 3d world and fixed some last bugs. Fixed rendering of 2d critter sprites. Added some code to read in the models from the executable (not used for release). Fixed doxygen documentation generation and updated the uw-formats.txt with 3d models info. FMOD support was ripped away.
            </p>

            <h3>2002-11-18</h3>
            <p>
                Ripped away the old 2d collision detection code. wjp fixed last things on the Linux build system.
            </p>

            <h3>2002-11-15</h3>
            <p>
                Fixed conversation graph stuff. Added Lua callback function to retrieve all object properties. Added first try on looking objects in the underworld.
            </p>

            <h3>2002-11-13</h3>
            <p>
                Fixed the tools today, made some changes related to the player height and added player repositioning when changing the level with Alt+PageUp or Alt+PageDown, so that users can see more of the underworld in the next release. Fixed some minor problems and glitches.
            </p>

            <h3>2002-11-12</h3>
            <p>
                Merged most of Fabian Pache's additions to the uw-formats.txt file related to uw2 format differences. Fixed uw_demo usage in uwadv and changed the configure script to (hopefully) work under MacOS X (after Fingolfin's remarks).
            </p>

            <h3>2002-11-10</h3>
            <p>
                QQtis redid "Descent" (which sounds much better now) and started with "Wanderer". Always available at <a href="http://www.wam.umd.edu/~mshetty/music/" target="_blank">QQtis music folder</a>.
            </p>

            <h3>2002-11-08</h3>
            <p>
                Telemachos improved the game physics again and tweaked gravity to behave more realistic.
            </p>

            <h3>2002-11-07</h3>
            <p>
                Found a neat and easy way to fix those thin black lines at OpenGL texture borders by using GL_CLAMP_TO_EDGE as wrapping parameter. Also wrote man pages for uwadv and ua--lowercase-all.pl and packaged them into the rpm.
            </p>

            <h3>2002-11-05</h3>
            <p>
                Incorporated the conversation graph code into cnvdasm and removed the old one (was much too crappy :) Also redid the disassembler, which was an easy task.
            </p>

            <h3>2002-11-04</h3>
            <p>
                Started to rewrite decompiling the uw1 conv. code after glancing through a book about compiler building ("Ubersetzerbau"). Decompiled code also helps to understand meaning of most imported functions. The code is seen as a directed graph of opcodes that can be folded to C-like functions, statements and expressions. In the far future decompiled code text could be used in a visual conv. code debugger.
            </p>

            <h3>2002-10-30</h3>
            <p>
                Found a bug (in the OpenGL driver or somewhere) that prevents using mipmapped textures together with alpha blending. Used alpha testing (via glAlphaFunc()) to ignore rendering order. "Descent" is now played when entering the Abyss.
            </p>

            <h3>2002-10-28</h3>
            <p>
                Added critter rendering, although only the first frame is rendered. Disabled the savegame related features for next release. Also fixed some stuff.
            </p>

            <h3>2002-10-27</h3>
            <p>
                Telemachos fixed collision code and also introduced gravity (which is way too slow yet), but nice work! QQtis digitally rendered two more music pieces, "Descent" and "Maps &amp; Legends", available <a href="http://www.wam.umd.edu/~mshetty/music/" target="_blank">here</a>.
            </p>

            <h3>2002-10-26</h3>
            <p>
                Fixed a few bugs and glitches, added fading out for music and discovered that the Linux SDL_mixer midi driver doesn't play anything since the code was missing to write a temporary midi file (very ugly!). Also moved the gamestrings object to the underworld (needed by lua script bindings), and custom keymaps are loaded from the %uahome% folder now (when available). QQtis was added to the "about us" page and is member of the team now.
            </p>

            <h3>2002-10-25</h3>
            <p>
                Corey Day started to do some 3d modeling for the uwadv project.
            </p>

            <h3>2002-10-21</h3>
            <p>
                Jim visited the irc channel and we discussed model loading a bit, which helped my understanding of the models greatly. We'll see what is included in the next release, though. For the msvc project files I moved some source files (critloader.cpp and gamestrings.cpp) to a separate static linked library that has optimizations switched on, which gives some speed improvements during debugging.
            </p>

            <h3>2002-10-20</h3>
            <p>
                Found out that using a std::list is much more performant when doing a push_back() than using a std::vector, but loading times only went down to 20 seconds in debug mode. Unfortunately, MSVC cannot be configured to partially use optimizations in debug builds.
            </p>

            <p>
                Also found a new interesting site, <a href="http://www.salikon.dk/quillframe.html" target="_blank">Quill Dragon's</a>. Above other things, he has some manuals, and you can play Nim with Dr. Cat (and even beat him!). And there were some good laughs on the <a href="http://home.hiwaay.net/~rgregg/ultima/literal/" target="_blank">U7 book transcripts</a> from Underworld Dragon. And found an implementation of OpenGL that could world on handhelds: <a href="http://fabrice.bellard.free.fr/TinyGL/" target="_blank">TinyGL</a>. Whew, what a load-o-stuff :)
            </p>

            <h3>2002-10-18</h3>
            <p>
                Added a %uahome% variable to have a common placeholder for all systems. Added critter loading. Strange thing is that it needs 48 seconds in debug mode, and only 4 seconds in release mode!
            </p>

            <h3>2002-10-17</h3>
            <p>
                Added resampling code for the .voc files to resample from 12048 Hz to 22050 Hz (actually, 22088 Hz). The reason for this was that the SDL_mixer base sample rate was at 12000 Hz, which caused ogg vorbis files to play back too slow. Selecting 22050 Hz as sample rate (a recommended default) plays the .voc files too fast (internal resample routines of SDL_mixer only worked when resampling with integer factors, not with fractional values).
            </p>

            <p>
                I chose a resampling factor of 6 : 11 that gave almost the exact target bitrate (off by 38 Hz) and kept the resampling filter coefficients short. The algorithm used was taken from <a href="http://www.dspguru.com/sw/opendsp/alglib.htm" target="_blank">dspguru.com's algorithm library</a>. The lowpass filter was designed with FIRfilt, a tool from the uni's dsp lab. At last it pays off to have digital signal processing as a subject :)
            </p>

            <h3>2002-10-16</h3>
            <p>
                Invented a underworld access API for access of uadebug to the ua_underworld object and its members. Player Info in the debugger is filled now (unfortunately, the uadebug.dll can't be used with mingw32). Also added usage of precompiled headers to uadebug, which speeds up compilation quite a bit. Mailed the author of the <a href="http://www.anthemion.co.uk/wxworkshop/docs/html/fl/fl.htm" target="_blank">fl library</a> (it's part of the new wxWindows beta release) used about a possible bug.
            </p>

            <h3>2002-10-13</h3>
            <p>
                Jim found out more about the tilemap format, especially about enchantments and "free lists" for the master object list.
            </p>

            <h3>2002-10-11</h3>
            <p>
                Rewrote collision detection to use real 3d, as in the <a href="http://www.peroxide.dk/download/tutorials/tut10/pxdtut10.html" target="_blank">peroxide tutorial</a> but it doesn't work yet, so I disabled it again. Also fixed item combining.
            </p>

            <h3>2002-10-10</h3>
            <p>
                Restricted mouse movement in "mouse movement mode" to the 3d view window. Also fixed a bug with the mode.
            </p>

            <h3>2002-10-07</h3>
            <p>
                Martin Shetty started to rearrange uw1's midi tracks using software synthesizer and converted it to mp3. A bug in uwadv prevents to play back external music yet.
            </p>

            <h3>2002-10-06</h3>
            <p>
                Added sliding left/right and added mouse movement (and better than in the original :-). Also hacked a bit more on the critters decoding.
            </p>

            <h3>2002-10-05</h3>
            <p>
                Added makeshift savegame saving screen and got loading and saving to work. Used zlib deflate compression for the savegames, which decreases file size from about 870kb to 66kb.
            </p>

            <h3>2002-10-02</h3>
            <p>
                Moved some movement code to the physics class, preparing for a collision detection remake. Added keymap loading from file. Also fixed all tools apart from the mapdisp.
            </p>

            <h3>2002-10-01</h3>
            <p>
                Finally got the ua_underworld independent of the user interface classes. Also finished the makeshift savegame loading screen. Also worked on the key mapping a bit.
            </p>

            <h3>2002-09-30</h3>
            <p>
                Telemachos found some <a href="http://sourceforge.net/mailarchive/forum.php?thread_id=1129269&amp;forum_id=10460" target="_blank">old mails</a> from Doug Church (chief? developer of uw1) that explain some stuff with uw1's renderer and 3d model system. He also found out his current email address, as well as <a href="http://www.dfan.org/" target="_blank">Dan Schmidt's home page</a> (along with a nice little <a href="http://www.dfan.org/writing/comment.html" target="_blank">uw1 story</a>).
            </p>

            <h3>2002-09-28</h3>
            <p>
                dforger introduced his <a href="http://sourceforge.net/projects/uw2rev/" target="_blank">uw2 remake project</a> to me today. Dirk pointed me to another <a href="http://screwage.com/~marc/" target="_blank">uw2 project</a> that also looks promising.
            </p>

            <h3>2002-09-27</h3>
            <p>
                fixed the small lines problem, at least for the message scroll class.
            </p>

            <h3>2002-09-26</h3>
            <p>
                Jim found out most stuff about enchantments on weapons and other items, which is a great find!
            </p>

            <h3>2002-09-24</h3>
            <p>
                wjp fixed an inventory bug that I seemed to have created when moving some lua scripts around. texture wrapping parameters are stored in the texture class now. Oh, and we are mentioned <a href="http://www.martinmanning.com/interpreters.htm#underworldadventures" target="_blank">here</a>; they claim we even support uw2 in the future :-))
            </p>

            <h3>2002-09-22</h3>
            <p>
                found a way how uwadv could be finished faster: <a href="http://www.kuro5hin.org/story/2002/4/15/103358/720" target="_blank">Uberman's sleep schedule</a> :)
            </p>

            <h3>2002-09-20</h3>
            <p>
                implemented debugger interface class and added uadebug project to build the dll (or shared library) that contains the debugger. for now it only opens a MDI frame window. The whole stuff uses the latest wxWindows libraries.
            </p>

            <h3>2002-09-16</h3>
            <p>
                Trying around with <a href="http://www.wxwindows.org/" target="_blank">wxWindows</a> a bit, a platform independent UI library. Seems to be a nice thing for the Underworld Debugger I'm planning to do.
            </p>

            <h3>2002-09-15</h3>
            <p>
                The uw2 I ebayed earlier this month arrived, so uw2 support should be in soon ... eerm, joke! :-)
            </p>

            <h3>2002-09-11</h3>
            <p>
                Posted the "3d modeler" job offer today, and also on <a href="http://www.planetquake.com/polycount/">Polycount</a>. Several people applied but they didn't reply to my introduction ... yet.
            </p>

            <h3>2002-09-10</h3>
            <p>
                Worked on the Lua script bindings, and all needed functions should be there now, as well as a script callback interface class.
            </p>

            <h3>2002-09-08</h3>
            <p>
                Added a text scroll class to handle all text scroll things needed in ingame and conversation screens.
            </p>

            <h3>2002-09-07</h3>
            <p>
                Reworked the ingame_orig screen to use separate textures for different UI elements. Texture sizes for the ingame_orig, the start_splash and the ack'ments screens are max. 256x256, to get older voodoo cards to work.
            </p>

            <h3>2002-09-06</h3>
            <p>
                Moved all underworld OpenGL rendering code to own class, to keep it separated from underworld data. Object and wall selection works, too. Also used Telemachos advice to adjust texture wrap mode to GL_CLAMP for some objects. Willem added a configure script option to exclude building the tools (they are broken since the renderer changes).
            </p>

            <h3>2002-09-05</h3>
            <p>
                Modified gamestrings loader to use SDL_RWops to load game strings from uadata resources, too (for the future). More minor modifications.
            </p>

            <h3>2002-09-03</h3>
            <p>
                Discussions on the mailing list about the savegame implementation. I've implemented a savegames manager class after that. Also added a levelmap to 3ds converter tool that uses <a href="http://lib3ds.sourceforge.net/" target="_blank">lib3ds</a>. Also had contact with Peter Jay Salzman from <a href="http://www.tldp.org/HOWTO/Linux-Gamers-HOWTO/index.html" target="_blank">The Linux Gamers' HOWTO</a> and we now have an <a href="http://www.tldp.org/HOWTO/Linux-Gamers-HOWTO/interpreters.html#AEN793" target="_blank">entry</a> in the "Interpreter" section. And found a good article: <a href="http://www.tiscali.co.uk/games/features/2002/04/16/gamesthatchangedtheworldultimaunderworld.html" target="_blank">Games that changed the world: Ultima Underworld</a>.
            </p>

            <h3>2002-08-27</h3>
            <p>
                I've added a rather long <a href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/uwadv/uwadv/docs/ua-todo-list.txt?rev=HEAD&amp;content-type=text/vnd.viewcvs-markup">todo-list</a> with various tasks to the CVS.
            </p>

            <h3>2002-08-25</h3>
            <p>
                Dirk set up a channel for general ultima remake discussion, #ultimaremakes, on irc.freenode.net.
            </p>

            <h3>2002-08-22</h3>
            <p>
                released another package, codename <a href="http://www.simpsonslibrary.com/butter.html" target="_blank">butterfinger</a>. For Linux, a RPM package (that needs the latest SDL_mixer-1.2.4 libraries) are available, too.
            </p>

            <h3>2002-08-20</h3>
            <p>
                Dirk finished the character creation screen! Yay! besides that, Linux and mingw32 makefiles were unified, so that only a Makefile.common has to be adjusted when new files are added. Telemachos and I decided to re-implement collision detection using the 3d version from his tutorial (previous one was just a 2d stripped down version). That also would allow for real object physics.
            </p>

            <h3>2002-08-18</h3>
            <p>
                added a screen resolution config setting; allows for other fullscreen resolutions. also updated zziplib to 0.10.65. Telemachos was added to the project to help out with the collision detection.
            </p>

            <h3>2002-08-16</h3>
            <p>
                started writing a settings config program for use with the nullsoft installer and added a "make installer" target to build the installer; the way objects in the object list are represented was changed to simplify the list.
            </p>

            <h3>2002-08-15</h3>
            <p>
                plenty of changes yesterday and today; added fading in/out for ingame screen, added using of m3u playlist for ingame music; added an experimental quicksave/quickload function, and many other internal changes.
            </p>

            <h3>2002-08-14</h3>
            <p>
                Dirk completed the user interface part of the character creation, so I took a screenshot <a href="index.php?page=screenshots">here</a>. He also <a href="http://www.surfing.net/ultima/ucg/uw1_pc.html" target="_blank">did</a> <a href="http://www.netassoc.net/ultima/japanese.htm" target="_blank">some</a> <a href="http://www17.big.or.jp/~kitaji/ultima/jultima/developer.htm" target="_blank">research</a> on the japanese playstation version of Ultima Underworld 1. There also exists a short <a href="http://uwadv.sourceforge.net/images/psxuw.zip">quicktime video</a>.
            </p>

            <h3>2002-08-12</h3>
            <p>
                a source only package was released today; the Linux build system should be almost complete now. on the same day the exultbot disconnected from #uwadv, while Willem is on vacation until Friday, so no logs are produced.
            </p>

            <h3>2002-08-08</h3>
            <p>
                the project now has an official IRC channel; Willem registered it and set up exultbot to produce channel logs. the config settings part of uwadv was redone, Dirk continues work on the character creation, and Willem works on the Linux build system (rpms are possible now).
            </p>

            <h3>2002-08-06</h3>
            <p>
                added script bindings for Lua and implemented object combining and inventory object classification (for paperdoll item dropping). configuration files are now read dependent on the platform (either plain uwadv.cfg or user-based config files for systems that support home directories.
            </p>

            <h3>2002-08-05</h3>
            <p>
                back from vacation; we decided to convert all dos-style line endings to unix-style ones. tried <a href="http://www.tortoisecvs.org/" target="_blank">tortoisecvs</a> today, which is rather nice (it also handles the cr-lf conversions properly). during the week wjp fixed a bug with the inventory and Dominus found a bluescreen-bug that may result from faulty SB Live drivers together with some midi devices. wjp also hacked apart the Linux makefiles.
            </p>

            <h3>2002-07-30</h3>
            <p>
                release day today! fixed some last inventory related things and the linux makefiles. btw, cheesecake is phlask's favourite food :). also added wjp (of exult project) as linux porter. and we have a new mailing list, uwadv-devel. oh, and I'm on a vacation until sunday.
            </p>

            <h3>2002-07-29</h3>
            <p>
                implemented inventory item interaction. Dirk already has some showable in the character creation.
            </p>

            <h3>2002-07-24</h3>
            <p>
                added some more stuff to the orig. ingame interface, e.g. the "command" buttons on the left. Dirk has started creating the character creation.
            </p>

            <h3>2002-07-23</h3>
            <p>
                changed the texture class interfaces (something that I wanted to do for long). also seemed to found the bug in the collision detection (but I think it created another).
            </p>

            <h3>2002-07-19</h3>
            <p>
                Dirk added settings for subtitle and/or speech to appear in cutscenes.
            </p>

            <h3>2002-07-18</h3>
            <p>
                Dirk completed the introduction cutscene script today, and it's amazing! the speech is almost lip synchronous with the animation.
            </p>

            <h3>2002-07-16</h3>
            <p>
                worked on the inventory class today (which isn't finished yet). also implemented the "acknowledgements" sequence, with a cool blend-over effect.
            </p>

            <h3>2002-07-15</h3>
            <p>
                added zziplib to have easy access to zip files. all uadata files will be stored in resource zip files for binary releases to keep file count small. it already works for loading the cutscene Lua script.
            </p>

            <h3>2002-07-14</h3>
            <p>
                finally found and fixed that linker error when using gcc-3.1 and libstdc++ together (STLport worked) by simply moving class methods that had the offending statement to the front of the cpp file.
            </p>

            <h3>2002-07-13</h3>
            <p>
                extended the cutscene control interface for Lua a bit, so that cutscenes that match the original ones could be implemented via Lua.
            </p>

            <h3>2002-07-12</h3>
            <p>
                added Dirk to the developer's list. for now he's working on the introduction cutscene Lua script.
            </p>

            <h3>2002-07-11</h3>
            <p>
                cutscene control via the Lua script is complete. I already wrote some timetable entries for the intro cutscene, but that is far from complete. took a screenshot from the intro. also started to write developers guide to the gal.. eerm source code.
            </p>

            <h3>2002-07-10</h3>
            <p>
                added the first Lua script, a script to control cutscenes. it should act more as a timetable for animation, speech sound and subtitle text. also discussed the new game interface uwadv additionally gets with Dirk.
            </p>

            <h3>2002-07-08</h3>
            <p>
                hooray! collision detection works! with the help of Telemachos (of <a href="http://www.peroxide.dk/ultima/" target="_blank">U1:R</a> fame), I finally got it to work. Dirk Manders sent in a patch for .voc file playback using <a href="http://www.libsdl.org/projects/SDL_mixer/" target="_blank">SDL_mixer</a> library. that one gets in after the next release of uwadv named ...
            </p>

            <p>
                <a href="http://www.vosen.com/English/Pastries/Poppy%20Pastry/poppy_pastry.htm" target="_blank">poppy pastries</a>! yes, another silly name, but that one actually tastes very good. a few bugs remain in uwadv, though. happy bug chasing! (there are at least 2 that I know of). after the CVS tagging, I noticed that animview isn't working anymore. I took the binary from the last release.
            </p>

            <h3>2002-07-05</h3>
            <p>
                tinkering with collision detection, but nothing to commit yet. improved underworld object and uw1 game importing while working on the game physics. today I also noticed that Underworld Adventures is part of <a href="http://sourceforge.net/foundry/games/" target="_blank">SourceForge's Games Foundary</a>.
            </p>

            <h3>2002-07-03</h3>
            <p>
                added working compass and player image to the user interface. rendering is even slower, now that the user interface image is uploaded to the graphics card every time the screen is rendered.
            </p>

            <h3>2002-07-01</h3>
            <p>
                enabled scissor testing in the ingame screen, so that the 3d world actually stays in the little window. also added the start menu (although only "journey onward" works at the moment). sorted out the screenshots so that they are a bit more representative. really should tackle that collision detection now.
            </p>

            <h3>2002-06-27</h3>
            <p>
                yay! I never thought that would work. I fixed the last bugs in the game strings tool and translated a bit of conversation (from the uw_demo) with bragit to german. I put a screenshot of the result in the screenshots section. hmm, maybe someone wants to do a uw1 translation project ...
            </p>

            <h3>2002-06-26</h3>
            <p>
                wrote a tool to unpack and repack the game strings. during that, I found a major bug that changed a lot of things how game strings are treated ingame. although, replacing the game strings with repacked ones in the original games doesn't work for conversations, yet. translations for uwadv for other languages will be possible, though.
            </p>

            <h3>2002-06-25</h3>
            <p>
                finished the starting splash screens that shows two still images ("origin presents" and "a blue sky production") and the intro animation with the burning Ultima Underworld logo. had to optimize texture upload to the graphics card a bit. Also put the main game user interface over the screen, to see how it looks. I've put two images into the screenshots.
            </p>

            <h3>2002-06-24</h3>
            <p>
                changed animview so that OpenGL is used to show the animation frames. works nicely, and I don't have to use a <a href="http://elektron.its.tudelft.nl/~dalikifa/" target="_blank">scaler</a>.
            </p>

            <h3>2002-06-21</h3>
            <p>
                delayed release of grainroll one day, to find a rather nasty bug. in the last few days it simply were too hot to do much on the computer (until I found <a href="http://vcool.occludo.net/" target="_blank">VCool</a>). next on my list to do is game physics, e.g. wall collision and such. I already have some ideas how to do this.
            </p>

            <h3>2002-06-17</h3>
            <p>
                added animview, a deluxe paint animation viewer (for the cutscenes in uw1/uw2) to the tools. maybe should do a release in the next few days. also fighted with the linux makefiles again. this time, it even compiles on MacOS X on SourceForge's compile farm.
            </p>

            <h3>2002-06-15</h3>
            <p>
                fixed wall texture drawing, the abyss door (among other textures) is now drawn correctly. also saw an article about the <a href="http://www.ziosoft.com/product.html?n=9" target="_blank">uw1 for pocket pc</a> in the german magazine <a href="http://www.heise.de/ct/" target="_blank">c't</a>.
            </p>

            <p>
                later in the day: just wrote a cutscenes animation viewer for the "hacking" folder in CVS.
            </p>

            <h3>2002-06-14</h3>
            <p>
                more or less implemented object drawing. mapdisp doesn't show the objects yet. also added some more linux makefile stuff, suggested by Larry Reeder. also fixed a bug where a wall next to a diagonal tile wasn't drawn. as a totally unrelated note, farbrausch's newest 64k-demo <a href="http://www.theproduct.de/" target="_blank">poemtoahorse</a> was a iotd on flipcode. and it's awesome!
            </p>

            <h3>2002-06-12</h3>
            <p>
                I took a few days off from uwadv, to finish <a href="http://winLAME.sourceforge.net/" target="_blank">another project</a>. I also thought about how to integrate the scripting language <a href="http://www.lua.org/" target="_blank">Lua</a> into uwadv, to manage ingame actions and NPC behavior, as well as character creation or cutscenes control.
            </p>

            <h3>2002-05-28</h3>
            <p>
                today I did more object list loading and object rendering. I just rendered a box for every object in the map. I took a nice screenshot in the green goblins area.
            </p>

            <h3>2002-05-25</h3>
            <p>
                hopefully finished Linux (or FreeBSD or MacOS X) configure/make files. for now.
            </p>

            <h3>2002-05-23</h3>
            <p>
                a friend with a FreeBSD box got me shell access to try out compiling uwadv on it. first we had to install SDL-1.2.5 from CVS and do some nasty symlinks to get ./configure to work. it finally worked and we made a screenshot of the mapdisp program. it ran at impressive 2 fps on the 266mhz box. also got it (more or less) on MacOS X on SourceForge's compile farm. had a hard time to run it, though.
            </p>

            <h3>2002-05-22</h3>
            <p>
                released win32 binary compile of the tools, mapdisp, cnvdbg and xmi2mid, codename "whoopie". whoopie!
            </p>

            <h3>2002-05-16</h3>
            <p>
                made a map display program (mapdisp) in an hour, using components of uwadv. it shows the level maps, and they can be moved with the mouse.  looks nice!
            </p>

            <h3>2002-05-12</h3>
            <p>
                uwadv is mentioned on http://www.stygianabyss.com/, thanks Elenkis!
            </p>

            <h3>2002-05-09</h3>
            <p>
                Tels contacted me on how to build uwadv for Linux. from there on improved my knowledge about automake/autoconf, and after more annoyances installed the last versions of the autotools, resulting in a hopefully working set of Linux build tools.
            </p>

            <h3>2002-05-08</h3>
            <p>
                finished my quadtree frustum culling code (tough thing!) and added it to uwadv. speedup from ~70 to 150 fps on my Duron 600MHz / GeForce2 MX.
            </p>

            <h3>2002-05-05</h3>
            <p>
                made my first pre-alpha release. I didn't liked the idea of boring version numbers, and a friend came up with the first release codename, so I took it. "ricecraecker" lets you run through the underworld map (and through walls) and plays some midi in the background. I also remade the project home page.
            </p>

            <h3>2002-04-26</h3>
            <p>
                started a uw1 conversation decompiler, which even seems to work, more or less. the conversation code seems to be compiled from a higher language that is C-like. there are function parameters and return values, and even a switch statement.
            </p>

            <h3>2002-04-16</h3>
            <p>
                Dominus Dragon reports the first bug, a crash bug, which is fixed now. was in the audio part.
            </p>

            <h3>2002-04-10</h3>
            <p>
                the "Underworld Adventures" project is registered at SourceForge. I'm starting to set up things, as well as checking in code already written. a cvs checkins mailing list is also created (might be useful later on).
            </p>

            <h3>2002-04-08</h3>
            <p>
                adapted the Exult xmidi playing code written by Colourless Dragon for my project to play the xmi files. works rather nice. also made a zip file with a bunch of files that shows what uwadv already can do.
            </p>

            <h3>2002-03-12</h3>
            <p>
                started some hacking projects to find out more infos about the files, as well as testing to extract needed data for the game. ongoing discussions with Jim about various aspects of the game's files.
            </p>

            <h3>2002-03-11</h3>
            <p>
                Telemachos of u1 remake fame (he did the Underworld Viewer) answered my mail pointing me to the TSSHP project. Jim and the others already found out much of ultima underworld's file formats.
            </p>

            <!-- content end -->
        </div>
    </div>

    <!-- footer bar -->
    <div class="bordered-box light-background">
        <p style="text-align:center; margin:8px;">
            E-Mail:<img src="images/mailgray.png" style="vertical-align:middle; border: 0px" alt="vividos' mail address" />
        </p>
    </div>

</body>
</html>
